<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>D3D Rechnungs-Tool PRO</title>
<style>
:root {
--bg-color: #1a1d21;
--card-bg: #24292e;
--accent-blue: #00a8ff;
--text-color: #ffffff;
--border-color: #3f4448;
}

* { box-sizing: border-box; }
body { font-family: 'Segoe UI', sans-serif; background: var(--bg-color); color: var(--text-color); margin: 0; padding: 20px; }

.container {
max-width: 900px;
margin: auto;
background: var(--card-bg);
padding: 40px;
border-radius: 12px;
box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

/* Toolbar */
.no-print { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
button {
padding: 10px 15px; border-radius: 6px; border: none; cursor: pointer; font-weight: bold;
background: var(--accent-blue); color: white; transition: 0.3s;
}
button:hover { opacity: 0.8; }

/* Header Layout */
.header-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }

.logo-area h1 { font-size: 45px; margin: 0; color: var(--accent-blue); letter-spacing: 5px; line-height: 1; }
.logo-area p { font-size: 12px; margin: 5px 0 0 0; opacity: 0.8; }

.meta-info-block {
background: rgba(255,255,255,0.05);
padding: 15px;
border-radius: 8px;
min-width: 250px;
}
.meta-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 13px; }
.meta-row input { background: transparent; border: none; color: white; text-align: right; width: 110px; border-bottom: 1px solid #555; }

.doc-title { font-size: 28px; font-weight: bold; text-transform: uppercase; margin: 20px 0; color: var(--accent-blue); }

/* Address */
.address-section { margin: 20px 0 40px 0; }
.address-section strong { font-size: 16px; color: var(--accent-blue); text-decoration: underline; }
.address-section input { background: transparent; border: none; border-bottom: 1px solid var(--border-color); color: white; display: block; width: 350px; padding: 8px 0; margin-bottom: 5px; font-size: 15px; }

/* Table Style */
table { width: 100%; border-collapse: collapse; margin: 20px 0; }
th { border-bottom: 2px solid var(--accent-blue); padding: 12px; text-align: left; font-size: 13px; text-transform: uppercase; }
td { border-bottom: 1px solid var(--border-color); padding: 12px 10px; }
input.table-input { background: transparent; border: none; color: white; width: 100%; }

/* Rechnungsbetrag & Status */
.total-area { margin-top: 30px; text-align: right; padding-right: 10px; }
.grand-total { font-size: 22px; font-weight: bold; margin-bottom: 5px; }
.status-text { font-size: 16px; color: var(--accent-blue); font-style: italic; }

/* Footer */
.legal-notices { margin-top: 50px; text-align: center; font-size: 12px; line-height: 1.6; }
.divider { border: 0; border-top: 1px solid var(--border-color); margin: 20px 0; }

.footer-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; font-size: 10px; color: #aaa; }

@media print {
@page { margin: 10mm; }
body { background: white; color: black; padding: 0; }
.container { box-shadow: none; width: 100%; padding: 0; background: white; }
.no-print { display: none !important; }
input, select { color: black !important; border: none !important; }
.meta-info-block { background: #f0f0f0 !important; -webkit-print-color-adjust: exact; }
.meta-row input { color: black !important; }
th { border-bottom: 2px solid black !important; color: black !important; }
td { border-bottom: 1px solid #ccc !important; color: black !important; }
.doc-title, .address-section strong, .grand-total, .status-text { color: black !important; }
.divider { border-top: 1px solid black !important; }
}
</style>
</head>
<body>

<div class="no-print">
<button onclick="window.print()">üñ®Ô∏è Drucken / PDF</button>
<button onclick="sendEmail()" style="background: #e67e22;">üìß Per E-Mail senden</button>
<button onclick="addItem()" style="background: #2ecc71;">+ Position</button>
<button onclick="saveNewProduct()" style="background: #34495e;">üíæ Produkt speichern</button>
<button onclick="toggleDoc()" id="typeBtn" style="background: #9b59b6;">Zu Angebot wechseln</button>
</div>

<div class="container">
<header class="header-top">
<div class="logo-area">
<h1>D3D</h1>
<p>Graf-Sempt-Str. 27, 85601 Forstinning<br>Deutschland</p>
</div>
<div class="meta-info-block">
<div class="meta-row"><span>Datum:</span><input type="text" id="date"></div>
<div id="invoiceFields">
<div class="meta-row"><span>Rechnungsnr:</span><input type="text" id="invNum" value="2026-001"></div>
<div class="meta-row"><span>Zahlungsziel:</span><input type="number" id="dueDays" value="14" oninput="calcDates()"></div>
<div class="meta-row"><span>F√§llig am:</span><span id="dueDateText" style="float:right; width:110px; text-align:right;"></span></div>
</div>
</div>
</header>

<div class="doc-title" id="docTitle">Rechnung</div>

<div class="address-section">
<strong>Empf√§nger:</strong>
<input type="text" id="recName" placeholder="Name / Firma">
<input type="text" placeholder="Stra√üe Hausnummer">
<input type="text" placeholder="PLZ Ort">
<input type="text" placeholder="Handynummer (optional)">
</div>

<p id="intro" style="font-size: 13px;">Wir danken f√ºr Ihren Auftrag und berechnen diesen wie folgt:</p>

<table>
<thead>
<tr>
<th style="width:5%">Pos</th>
<th style="width:45%">Bezeichnung</th>
<th style="width:10%">Anzahl</th>
<th style="width:10%">Einheit</th>
<th style="width:15%">Preis (‚Ç¨)</th>
<th style="width:15%">Gesamt</th>
</tr>
</thead>
<tbody id="items"></tbody>
</table>

<div class="total-area">
<div class="no-print" style="margin-bottom: 10px;">
<select id="statusSelect" onchange="updateStatus()" style="background:#333; color:white; border:none; padding:5px; border-radius:4px;">
<option value="">Status w√§hlen...</option>
<option value="Bereits bezahlt (eBay)">Bereits bezahlt (eBay)</option>
<option value="Betrag in bar erhalten">Betrag in bar erhalten</option>
<option value="Betrag dankend erhalten">Betrag dankend erhalten</option>
<option value="Offen">Offen</option>
</select>
</div>
<div class="grand-total">Rechnungsbetrag: <span id="grandTotal">0.00</span> ‚Ç¨</div>
<div id="statusDisplay" class="status-text"></div>
</div>

<div class="legal-notices">
<p>Die gelieferte Ware bleibt bis zur vollst√§ndigen Bezahlung Eigentum von D3D.</p>
<p>Kein Steuerausweis aufgrund der Anwendung der Kleinunternehmerregelung (¬ß 19 UStG).</p>
<p><strong>Personalisierte und individuell angefertigte Waren sind vom Umtausch ausgeschlossen (¬ß312 Abs. 2 Nr. 1 BGB).</strong></p>
</div>

<hr class="divider">

<footer class="footer-grid">
<div>
<strong>D3D</strong><br>
Graf-Sempt-Str. 27<br>
85601 Forstinning<br>
Deutschland
</div>
<div>
<strong>Kontakt</strong><br>
E-Mail: kontakt.D3D@gmail.com<br>
Steuer-Nr.: 112/279/00204<br>
Ust-IdNr.: DE455897359-00001
</div>
<div>
<strong>Bankverbindung</strong><br>
IBAN: DE65 1001 1001 2856 6428 24<br>
BIC: NTSBDEB1XXX<br>
GF: Strzoda Dominic
</div>
</footer>
</div>

<datalist id="tpl"></datalist>

<script>
// Produkte aus LocalStorage laden oder Standard setzen
let products = JSON.parse(localStorage.getItem('d3d_products')) || ["Akkuhalter f√ºr Makita", "Versand, Verpackung & Versand"];
let isInvoice = true;

function updateDatalist() {
const list = document.getElementById('tpl');
list.innerHTML = products.map(p => `<option value="${p}">`).join('');
}

function saveNewProduct() {
const inputs = document.querySelectorAll('.prod-input');
inputs.forEach(input => {
if(input.value && !products.includes(input.value)) {
products.push(input.value);
}
});
localStorage.setItem('d3d_products', JSON.stringify(products));
updateDatalist();
alert("Produkte gespeichert!");
}

document.getElementById('date').value = new Date().toLocaleDateString('de-DE');

function addItem() {
const row = document.getElementById('items').insertRow();
const pos = document.getElementById('items').rows.length;
row.innerHTML = `
<td>${pos}</td>
<td><input class="table-input prod-input" list="tpl" placeholder="Produkt w√§hlen oder tippen..."></td>
<td><input type="number" class="table-input" value="1" oninput="calc()"></td>
<td><input class="table-input" value="St√ºck"></td>
<td><input type="number" class="table-input" value="0.00" step="0.01" oninput="calc()"></td>
<td class="row-total" style="font-weight:bold;">0.00</td>
`;
}

function calc() {
let total = 0;
[...document.getElementById('items').rows].forEach(row => {
const q = row.cells[2].querySelector('input').value;
const p = row.cells[4].querySelector('input').value;
const sub = q * p;
row.cells[5].innerText = sub.toFixed(2);
total += sub;
});
document.getElementById('grandTotal').innerText = total.toFixed(2);
}

function calcDates() {
const days = parseInt(document.getElementById('dueDays').value) || 0;
const d = new Date();
d.setDate(d.getDate() + days);
document.getElementById('dueDateText').innerText = d.toLocaleDateString('de-DE');
}

function toggleDoc() {
isInvoice = !isInvoice;
document.getElementById('docTitle').innerText = isInvoice ? "Rechnung" : "Angebot";
document.getElementById('typeBtn').innerText = isInvoice ? "Zu Angebot wechseln" : "Zu Rechnung wechseln";
document.getElementById('invoiceFields').style.display = isInvoice ? "block" : "none";
document.getElementById('intro').innerText = isInvoice ? "Wir danken f√ºr Ihren Auftrag und berechnen diesen wie folgt:" : "Gerne unterbreiten wir Ihnen folgendes Angebot:";
}

function updateStatus() {
document.getElementById('statusDisplay').innerText = document.getElementById('statusSelect').value;
}

function sendEmail() {
const name = document.getElementById('recName').value;
const nr = document.getElementById('invNum').value;
const subject = encodeURIComponent(`Rechnung ${nr} - D3D`);
const body = encodeURIComponent(`Hallo ${name},\n\nanbei erhalten Sie die Rechnung ${nr}.\n\nBeste Gr√º√üe,\nD3D`);
window.location.href = `mailto:kontakt.D3D@gmail.com?subject=${subject}&body=${body}`;
}

// Init
addItem();
calcDates();
updateDatalist();
</script>
</body>
</html>
